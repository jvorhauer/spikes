akka {
  extensions = [akka.persistence.Persistence]

  log-dead-letters = 10
  log-dead-letters-during-shutdown = on
  log-config-on-start = off
  loggers = ["akka.event.Logging$DefaultLogger"]
  loglevel = INFO
  stdout-loglevel = INFO

  actor {
    serializers {
      jackson-cbor = "akka.serialization.jackson.JacksonCborSerializer"
      jackson-json = "akka.serialization.jackson.JacksonJsonSerializer"
    }
    serialization-bindings {
      "spikes.model.Command" = jackson-cbor
      "spikes.model.Entity" = jackson-cbor
      "spikes.model.Event" = jackson-cbor
      "spikes.model.Response" = jackson-json
      "spikes.model.Users" = jackson-cbor
      "spikes.model.State" = jackson-cbor
    }
  }

  persistence {
    journal {
      plugin = "akka.persistence.cassandra.journal"
      auto-start-journals = ["akka.persistence.cassandra.journal"]
    }
    cassandra {
      session-provider = "akka.stream.alpakka.cassandra.DefaultSessionProvider"
      session-dispatcher = "akka.persistence.cassandra.default-dispatcher"
      datastax-java-driver-config = "datastax-java-driver"
    }
    snapshot-store {
      plugin = "akka.persistence.snapshot-store.local"
      auto-start-snapshot-stores = ["akka.persistence.snapshot-store.local"]
    }
  }
}

datastax-java-driver {
  basic {
    session-keyspace = "akka"
    cloud {
      secure-connect-bundle = ${ASTRA_SCB}
    }
  }
  advanced {
    auth-provider {
      class = PlainTextAuthProvider
      username = ${ASTRA_USERNAME}
      password = ${ASTRA_PASSWORD}
    }
    reconnect-on-init = true
  }
}

h2mem = {
  url = "jdbc:h2:mem:spikes;DB_CLOSE_DELAY=-1"
  driver = org.h2.Driver
  connectionPool = disabled
  keepAliveConnection = true
}

kamon {
  environment.service = "Spikes"
  apm.api-key = "4cnvlgc6elqs1totrku8vih8ko"
}
